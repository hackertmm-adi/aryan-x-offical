<html lang="en"><head>
    <meta charset="UTF-8">
    <title>aryan x offical</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <style>
        :root {
            --bg-color: #f4f6f9;
            --surface-color: #ffffff;
            --primary-accent-color: #00bfa5;
            --primary-accent-dark-color: #00a790;
            --new-tag-color: #ff3d71;
            --text-color-primary: #1a202c;
            --text-color-secondary: #5f6368;
            --text-color-on-accent: #ffffff;
            --border-color: #e2e8f0;
            --shadow-color-light: rgba(0, 0, 0, 0.05);
            --shadow-color-medium: rgba(0, 0, 0, 0.1);
            --star-color: #fbbc04;
            --premium-color: #ffab00;
            --admin-color: #673ab7;
            --danger-color: #ff3d71;
            --success-color: #4caf50;
            --upi-color: #6F4EFF;
            /* Placeholder SVG for general items - looks like a generic app icon */
            --placeholder-img-svg: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjZWFkY2UwIiBzdHJva2U9IiNhMGE0YTgiIHN0cm9rZS13aWR0aD0iMSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWNhcD0icm91bmQiPjxyZWN0IHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgeD0iMyIgeT0iMyIgcnh9PSIyIiByeT0iMiIvPjxjaXJjbGUgY3g9IjguNSIgY3k9IjguNSIgcj0iMS41Ii8+PHBvbHlsaW5lIHBvaW50cz0iMjEgMTUgMTYgMTAgNSAyMCIvPjwvc3ZnPg==');
            --font-body: 'Poppins', sans-serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
            width: 100%;
            overflow-x: hidden;
        }

        body {
            background: var(--bg-color);
            color: var(--text-color-secondary);
            font-family: var(--font-body);
            line-height: 1.6;
            width: 100%;
            overflow-x: hidden;
            min-height: 100vh;
        }

        body.menu-active,
        body.search-active,
        body.lightbox-active,
        body.auth-active,
        body.premium-modal-active,
        body.profile-active,
        body.admin-active {
            overflow: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* Header */
        .header {
            background: var(--surface-color);
            padding: 12px 15px;
            box-shadow: 0 1px 3px var(--shadow-color-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .menu-btn,
        .search-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-color-primary);
            font-size: 26px;
            padding: 5px;
        }

        .app-logo img {
            height: 40px;
            width: auto;
            display: block;
            border-radius: 8px;
        }

        .app-logo {
            cursor: pointer;
        }

        .app-title {
            font-size: 22px;
            font-weight: 600;
            color: var(--text-color-primary);
        }

        /* Search Overlay */
        .search-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--surface-color);
            z-index: 2100;
            display: flex;
            flex-direction: column;
            padding: 15px;
            transform: translateY(-100%);
            transition: transform 0.3s ease-in-out;
            visibility: hidden;
        }

        .search-overlay.active {
            transform: translateY(0);
            visibility: visible;
        }

        .search-overlay-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        #mainSearchInput {
            flex-grow: 1;
            padding: 12px 15px;
            border-radius: 25px;
            border: 1px solid var(--border-color);
            background: var(--bg-color);
            font-size: 16px;
            outline: none;
            margin-right: 15px;
        }

        .close-search-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-color-primary);
            font-size: 16px;
            font-weight: 500;
        }

        #searchResultsContainer {
            flex-grow: 1;
            overflow-y: auto;
        }

        /* Side Menu */
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1999;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .menu-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .side-menu {
            position: fixed;
            top: 0;
            left: 0;
            height: 100%;
            width: 90%;
            max-width: 320px;
            background: var(--surface-color);
            z-index: 2000;
            transform: translateX(-100%);
            transition: transform 0.3s ease-in-out;
            display: flex;
            flex-direction: column;
            padding: 20px;
        }

        .side-menu.active {
            transform: translateX(0);
        }

        .side-menu-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
        }

        .side-menu-brand {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .side-menu-brand img {
            height: 48px;
            width: 48px;
            border-radius: 10px;
        }

        .side-menu-brand .app-title {
            font-size: 24px;
        }

        .close-menu-btn {
            background: var(--bg-color);
            border: none;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-color-primary);
        }

        .close-menu-btn .material-icons {
            font-size: 24px;
        }

        .side-menu-nav {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }

        .side-menu-nav-item {
            background: var(--bg-color);
            padding: 20px 15px;
            border-radius: 16px;
            text-align: center;
            text-decoration: none;
            color: var(--text-color-primary);
            transition: background-color 0.2s ease;
            cursor: pointer;
        }

        .side-menu-nav-item:hover {
            background-color: #e9eef3;
        }

        .side-menu-nav-item .material-icons {
            font-size: 28px;
            margin-bottom: 8px;
        }

        .nav-home .material-icons {
            color: #fbbc04;
        }

        .nav-apps .material-icons {
            color: #ab47bc;
        }

        .nav-games .material-icons {
            color: #ff3d71;
        }

        .nav-editing .material-icons {
            color: #42a5f5;
        }

        .side-menu-footer {
            margin-top: auto;
            text-align: center;
        }

        .side-menu-footer a {
            display: block;
            margin-bottom: 15px;
            color: var(--text-color-secondary);
            text-decoration: none;
            font-size: 14px;
        }

        .side-menu-footer a:hover {
            color: var(--primary-accent-color);
        }

        /* Section Header */
        .section-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 28px 0 16px 0;
        }

        .section-icon {
            color: var(--primary-accent-color);
            font-size: 28px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-color-primary);
        }

        /* Carousel */
        .popular-carousel {
            display: flex;
            gap: 20px;
            overflow-x: auto;
            padding: 60px 15px 20px 15px;
            scroll-snap-type: x mandatory;
            scroll-padding-left: 15px;
            scrollbar-width: none;
            -ms-overflow-style: none;
            margin: 0 -15px;
        }

        .popular-carousel::-webkit-scrollbar {
            display: none;
        }

        .popular-card-item {
            flex: 0 0 280px;
            position: relative;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            scroll-snap-align: start;
            margin-bottom: 20px;
        }

        .popular-card-item:hover .popular-card-base {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        }

        .popular-card-base {
            width: 100%;
            height: 200px;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            background: var(--surface-color);
            box-shadow: 0 10px 25px var(--shadow-color-medium);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .popular-card-abstract-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: inherit;
            overflow: hidden;
            z-index: 0;
        }

        .popular-card-abstract-bg svg {
            width: 100%;
            height: 100%;
            display: block;
        }

        .android-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
            color: var(--text-color-primary);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 15;
        }

        .android-badge .material-icons {
            font-size: 16px;
            color: #a4c639;
            line-height: 1;
        }

        .popular-app-logo-wrapper {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100px;
            height: 100px;
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            z-index: 10;
            background-color: white;
            border: 3px solid white;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .popular-app-logo {
            width: 100%;
            height: 100%;
            object-fit: contain;
            border-radius: inherit;
        }

        .popular-app-logo.placeholder {
            object-fit: scale-down;
            padding: 15%;
            background-color: transparent;
            content: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmYWxsPSJub25lIiBzdHJva2U9IiM1ZjYzNjgiIHN0cm9rZS13aWR0aD0iMS41IiBzdHJva2UtbGluZWNjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cmVjdCB3aWR0aD0iMjAiIGhlaWdoPSIyMCIgeD0iMiIgeT0iMiIgcj0iMiIvPjxwYXRoIGQ9Im05IDExIDMuMTMtMy4xM2ExLjUgMS41IDAgMCAxIDIuMTIwIiAvPjxwYXRoIGQ9Ik01IDE2bDQtMS41IDQgNC0yLjQ0OCAyLjU2NmEyIDIgMCAwIDEtLjY4Mi0uNzA1IiAvPjwvc3ZnPg==');
        }

        .popular-card-app-name {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-color-primary);
            margin-top: 15px;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
            padding: 0 5px;
        }

        .popular-card-info,
        .popular-card-promo .mixhub-logo-small {
            display: none;
        }

        /* Item Grids */
        .item-grid {
            display: grid;
            gap: 16px;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        }

        .item-card {
            background: var(--surface-color);
            border-radius: 16px;
            box-shadow: 0 2px 8px var(--shadow-color-light);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            text-align: center;
            padding: 15px;
            position: relative;
            cursor: pointer;
        }

        .item-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px var(--shadow-color-medium);
        }

        .item-card-icon-container {
            width: 70px;
            height: 70px;
            margin: 0 auto 12px auto;
            border-radius: 18px;
            overflow: hidden;
        }

        .item-card-icon {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .item-card-icon.placeholder {
            object-fit: scale-down;
            padding: 20%;
            background-color: var(--bg-color);
            background-image: var(--placeholder-img-svg);
            background-size: 60%;
            background-position: center;
            background-repeat: no-repeat;
        }

        .new-tag {
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--new-tag-color);
            color: white;
            font-size: 10px;
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .new-tag::before {
            content: '';
            display: block;
            width: 6px;
            height: 6px;
            background: white;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }

        .item-card-title {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-color-primary);
            margin-bottom: 2px;
            line-height: 1.3;
            word-break: break-word;
        }

        .item-card-type {
            font-size: 12px;
            color: var(--text-color-secondary);
            margin-bottom: 8px;
        }

        .item-card-info {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            color: var(--text-color-secondary);
            opacity: 0.8;
            border-top: 1px solid var(--border-color);
            padding-top: 8px;
            margin-top: 8px;
        }

        .editing-grid {
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
        }

        .editing-card .item-card-icon-container {
            width: 100%;
            height: auto;
            padding-top: 150%;
            position: relative;
        }

        .editing-card .item-card-icon {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .editing-card .item-card-info {
            display: none;
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: flex-start;
            align-items: center;
            padding: 25px 15px;
            gap: 8px;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .pagination::-webkit-scrollbar {
            display: none;
        }

        .page-link {
            cursor: pointer;
            color: var(--text-color-secondary);
            border: 1px solid var(--border-color);
            background-color: var(--surface-color);
            padding: 8px 14px;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.2s ease;
            font-size: 14px;
            white-space: nowrap;
        }

        .page-link:hover,
        .page-link.active {
            background-color: var(--primary-accent-color);
            color: var(--text-color-on-accent);
            border-color: var(--primary-accent-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px -2px rgba(0, 191, 165, 0.4);
        }

        .page-link.arrow {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* News & Footer Banner */
        #news-banner-container {
            padding: 10px 0 20px 0;
        }

        .news-banner {
            background: var(--text-color-primary);
            color: var(--text-color-on-accent);
            padding: 20px 25px;
            border-radius: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .news-banner:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
        }

        .news-banner .section-title {
            color: var(--text-color-on-accent);
            font-size: 18px;
        }

        .news-banner .material-icons {
            font-size: 20px;
            background-color: rgba(255, 255, 255, 0.15);
            border-radius: 50%;
            padding: 6px;
        }

        .footer-banner {
            margin-top: 20px;
            padding: 25px;
            background: var(--surface-color);
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            text-align: center;
            box-shadow: 0 -2px 10px var(--shadow-color-light);
        }

        .footer-banner img {
            height: 50px;
            width: auto;
            border-radius: 10px;
        }

        .footer-banner p {
            font-size: 14px;
            color: var(--text-color-secondary);
        }

        /* Detail Section */
        #sectionDetail {
            padding: 20px 0;
            max-width: 700px;
            margin: 0 auto;
            animation: slideInUp 0.5s ease both;
        }

        .detail-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
        }

        .btn-back {
            background: none;
            border: none;
            color: var(--text-color-primary);
            font-size: 28px;
            cursor: pointer;
            margin-right: 15px;
            padding: 5px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s ease;
        }

        .btn-back:hover {
            background-color: var(--border-color);
        }

        .detail-title {
            font-size: 22px;
            font-weight: 600;
            color: var(--text-color-primary);
        }

        .detail-card {
            background: var(--surface-color);
            padding: 20px;
            border-radius: 16px;
            display: flex;
            gap: 20px;
            align-items: center;
            margin-bottom: 25px;
            animation: zoomIn 0.5s ease-out 0.1s both;
        }

        #detailAppImage {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            object-fit: cover;
            flex-shrink: 0;
        }

        #detailAppImage.placeholder {
            background-color: var(--bg-color);
            background-image: var(--placeholder-img-svg);
            background-size: 60%;
            background-position: center;
            background-repeat: no-repeat;
            padding: 15%;
        }

        .detail-info {
            flex-grow: 1;
        }

        #detailAppName {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-color-primary);
            line-height: 1.3;
        }

        #detailAppType {
            font-size: 14px;
            color: var(--text-color-secondary);
            margin: 2px 0 6px 0;
        }

        #detailStarRating {
            font-size: 14px;
            color: var(--text-color-secondary);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        #detailStarRating .stars {
            color: var(--star-color);
            font-size: 18px;
        }

        .detail-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 25px;
            justify-content: center;
        }

        .detail-actions .btn {
            flex: 1 1 auto;
            min-width: 150px;
            max-width: 100%;
            justify-content: flex-start;
            gap: 0;
        }

        .btn .material-icons {
            margin-right: 8px;
        }

        .button-label {
            flex-grow: 1;
            text-align: center;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.2s ease;
            font-family: var(--font-body);
            font-size: 15px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--primary-accent-color);
            color: var(--text-color-on-accent);
        }

        .btn-primary:hover {
            background: var(--primary-accent-dark-color);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--border-color);
            color: var(--text-color-primary);
        }

        .btn-secondary:hover {
            background: #d0d5db;
            transform: translateY(-2px);
        }

        .btn-premium {
            background: var(--premium-color);
            color: var(--text-color-on-accent);
        }

        .btn-premium:hover {
            background: #e69c00;
            transform: translateY(-2px);
        }

        .btn-upi {
            background: var(--upi-color);
            color: var(--text-color-on-accent);
        }

        .btn-upi:hover {
            background: #5d3be8;
            transform: translateY(-2px);
        }

        .btn-admin {
            background: var(--admin-color);
            color: var(--text-color-on-accent);
        }

        .btn-admin:hover {
            background: #5e35b1;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: var(--danger-color);
            color: var(--text-color-on-accent);
        }

        .btn-danger:hover {
            background: #e62e5e;
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success-color);
            color: var(--text-color-on-accent);
        }

        .btn-success:hover {
            background: #3d8b40;
            transform: translateY(-2px);
        }

        .btn-disabled {
            background: #e0e0e0 !important;
            color: #9e9e9e !important;
            cursor: not-allowed !important;
            transform: none !important;
        }

        .detail-section-content {
            margin-bottom: 25px;
            animation: fadeIn 0.5s ease-out 0.3s both;
        }

        .detail-section-content .subtitle {
            color: var(--text-color-primary);
            margin-bottom: 15px;
            font-size: 18px;
            font-weight: 600;
        }

        #detailAppDescContainer ul {
            list-style: none;
            padding-left: 0;
        }

        #detailAppDescContainer li {
            display: flex;
            align-items: flex-start;
            margin-bottom: 12px;
            font-size: 15px;
            color: var(--text-color-secondary);
            line-height: 1.6;
        }

        #detailAppDescContainer li .material-icons {
            margin-right: 12px;
            font-size: 22px;
            color: var(--primary-accent-color);
        }

        /* Screenshot Styles */
        .screenshot-gallery {
            overflow-x: auto;
            display: flex;
            gap: 12px;
            padding: 10px 0 15px 0;
            scrollbar-width: thin;
            scrollbar-color: var(--border-color) var(--bg-color);
        }

        .screenshot-gallery::-webkit-scrollbar {
            height: 8px;
        }

        .screenshot-gallery::-webkit-scrollbar-track {
            background: var(--bg-color);
            border-radius: 4px;
        }

        .screenshot-gallery::-webkit-scrollbar-thumb {
            background-color: var(--border-color);
            border-radius: 4px;
        }

        .screenshot-gallery::-webkit-scrollbar-thumb:hover {
            background-color: #c8d1db;
        }

        .screenshot-img {
            height: 250px;
            width: auto;
            border-radius: 12px;
            object-fit: cover;
            cursor: pointer;
            border: 1px solid var(--border-color);
            transition: transform 0.2s ease;
        }

        .screenshot-img:hover {
            transform: scale(1.03);
        }

        /* Review Section */
        .review-form {
            background: var(--surface-color);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 24px;
            animation: fadeInUpSmall 0.4s ease-out 0.4s both;
        }

        .review-form .subtitle {
            font-size: 16px;
            margin-bottom: 16px;
            margin-top: 0;
        }

        .star-rating {
            display: flex;
            justify-content: center;
            margin-bottom: 16px;
            direction: rtl;
        }

        .star-rating input {
            display: none;
        }

        .star-rating label {
            font-size: 32px;
            color: #ccc;
            cursor: pointer;
            transition: color 0.2s ease, transform 0.1s ease;
            padding: 0 2px;
        }

        .star-rating input:checked~label,
        .star-rating label:hover,
        .star-rating label:hover~label {
            color: var(--star-color);
            transform: scale(1.2);
        }

        input[type="text"],
        textarea {
            width: 100%;
            padding: 12px 14px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background: var(--bg-color);
            color: var(--text-color-primary);
            margin-bottom: 12px;
            font-size: 15px;
            font-family: var(--font-body);
            outline: none;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        input:focus,
        textarea:focus {
            border-color: var(--primary-accent-color);
            box-shadow: 0 0 0 3px rgba(0, 191, 165, 0.2);
        }

        textarea {
            resize: vertical;
            min-height: 90px;
        }

        .review-item {
            border-top: 1px solid var(--border-color);
            padding: 16px 0;
            animation: fadeIn 0.5s ease-out both;
        }

        .review-item:first-child {
            border-top: none;
            padding-top: 0;
        }

        .review-item p {
            margin: 4px 0;
            font-size: 14px;
            color: var(--text-color-secondary);
            word-break: break-word;
        }

        .review-item strong {
            color: var(--text-color-primary);
            font-weight: 600;
            font-size: 15px;
        }

        .review-item .review-stars {
            color: var(--star-color);
            font-size: 16px;
            margin-bottom: 6px;
        }

        /* Fullscreen Lightbox Styles */
        .lightbox-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 4000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
        }

        .lightbox-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .lightbox-content {
            position: relative;
            max-width: 95vw;
            max-height: 90vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .lightbox-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 8px;
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.5);
        }

        .lightbox-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            width: 44px;
            height: 44px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            transition: background-color 0.2s;
        }

        .lightbox-nav:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .lightbox-prev {
            left: -60px;
        }

        .lightbox-next {
            right: -60px;
        }

        .lightbox-close {
            position: absolute;
            top: -45px;
            right: -10px;
            background: none;
            border: none;
            color: white;
            font-size: 40px;
            cursor: pointer;
            line-height: 1;
            opacity: 0.8;
            transition: opacity 0.2s;
        }

        .lightbox-close:hover {
            opacity: 1;
        }

        /* Auth Modals */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 5000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .auth-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .auth-container {
            background: var(--surface-color);
            border-radius: 16px;
            width: 90%;
            max-width: 400px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .auth-modal.active .auth-container {
            transform: translateY(0);
        }

        .auth-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .auth-title {
            font-size: 22px;
            font-weight: 600;
            color: var(--text-color-primary);
        }

        .close-auth {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-color-secondary);
            font-size: 24px;
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .auth-form input {
            padding: 12px 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            font-size: 15px;
            outline: none;
            transition: border-color 0.2s ease;
        }

        .auth-form input:focus {
            border-color: var(--primary-accent-color);
        }

        .auth-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }

        .auth-switch {
            background: none;
            border: none;
            color: var(--primary-accent-color);
            cursor: pointer;
            font-size: 14px;
            text-decoration: underline;
        }

        .auth-error {
            color: #ff3d71;
            font-size: 14px;
            margin-top: 5px;
            text-align: center;
        }

        /* Premium Badge */
        .premium-badge {
            background: var(--premium-color);
            color: white;
            font-size: 12px;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 20px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-left: 8px;
        }

        .premium-badge .material-icons {
            font-size: 16px;
        }

        /* Admin Panel */
        .admin-panel {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        .admin-btn {
            background: var(--admin-color);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(103, 58, 183, 0.4);
            border: none;
            transition: transform 0.2s ease;
        }

        .admin-btn:hover {
            transform: scale(1.1);
        }

        .admin-menu {
            position: absolute;
            bottom: 60px;
            right: 0;
            background: var(--surface-color);
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
            padding: 15px;
            width: 250px;
            display: none;
        }

        .admin-menu.active {
            display: block;
        }

        .admin-menu-item {
            padding: 10px;
            cursor: pointer;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-menu-item:hover {
            background: var(--bg-color);
        }

        /* User Profile */
        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--primary-accent-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 16px;
        }

        .user-name {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-color-primary);
        }

        /* Premium Modal Styles */
        .premium-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 6000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .premium-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .premium-container {
            background: var(--surface-color);
            border-radius: 16px;
            width: 90%;
            max-width: 500px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            transform: translateY(20px);
            transition: transform 0.3s ease;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .premium-modal.active .premium-container {
            transform: translateY(0);
        }

        .premium-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .premium-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-color-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .premium-title .material-icons {
            color: var(--premium-color);
            font-size: 28px;
        }

        .close-premium {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-color-secondary);
            font-size: 24px;
        }

        .premium-status {
            background: var(--bg-color);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
        }

        .premium-status.active {
            background: linear-gradient(135deg, #ffab00 0%, #ff7043 100%);
            color: white;
        }

        .premium-status h3 {
            font-size: 18px;
            margin-bottom: 8px;
        }

        .premium-status p {
            font-size: 14px;
            margin-bottom: 0;
        }

        .premium-features {
            margin-bottom: 25px;
        }

        .premium-features h4 {
            font-size: 16px;
            color: var(--text-color-primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .premium-features h4 .material-icons {
            color: var(--premium-color);
        }

        .premium-features ul {
            list-style: none;
            padding-left: 0;
        }

        .premium-features li {
            display: flex;
            align-items: flex-start;
            margin-bottom: 12px;
            font-size: 15px;
            color: var(--text-color-secondary);
            line-height: 1.5;
        }

        .premium-features li .material-icons {
            margin-right: 12px;
            font-size: 20px;
            color: var(--premium-color);
        }

        /* Pricing Grid */
        .premium-pricing {
            margin-bottom: 25px;
        }
        
        .pricing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }
        
        .pricing-tier {
            background: var(--surface-color);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            border: 1px solid var(--border-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .pricing-tier:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .pricing-tier.popular {
            border: 2px solid var(--premium-color);
        }
        
        .popular-badge {
            position: absolute;
            top: -10px;
            right: 20px;
            background: var(--premium-color);
            color: white;
            font-size: 12px;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 20px;
        }
        
        .pricing-header {
            margin-bottom: 15px;
            text-align: center;
        }
        
        .pricing-header h3 {
            font-size: 18px;
            color: var(--text-color-primary);
            margin-bottom: 5px;
        }
        
        .price {
            font-size: 24px;
            font-weight: 700;
            color: var(--premium-color);
        }
        
        .save {
            font-size: 14px;
            color: var(--text-color-secondary);
        }
        
        .pricing-features {
            list-style: none;
            padding: 0;
            margin: 20px 0;
        }
        
        .pricing-features li {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            font-size: 14px;
            color: var(--text-color-secondary);
        }
        
        .pricing-features li .material-icons {
            font-size: 18px;
            color: var(--premium-color);
            margin-right: 8px;
        }

        /* Payment Methods */
        .payment-methods {
            margin-bottom: 25px;
        }
        
        .payment-options {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }
        
        .payment-option {
            flex: 0 1 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .payment-option.active {
            border-color: var(--upi-color);
            background-color: rgba(111, 78, 255, 0.1);
        }
        
        .payment-option img {
            height: 30px;
            margin-bottom: 8px;
        }
        
        .payment-option .material-icons {
            font-size: 30px;
            margin-bottom: 8px;
            color: var(--text-color-secondary);
        }
        
        .payment-option.active .material-icons {
            color: var(--upi-color);
        }

        /* User Profile Menu */
        .user-profile-menu {
            position: absolute;
            bottom: 50px;
            right: 0;
            background: var(--surface-color);
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
            padding: 15px;
            width: 250px;
            display: none;
            z-index: 1001;
        }

        .user-profile-menu.active {
            display: block;
        }

        .user-profile-menu-item {
            padding: 10px;
            cursor: pointer;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: background-color 0.2s;
        }

        .user-profile-menu-item:hover {
            background: var(--bg-color);
        }

        .user-profile-menu-item .material-icons {
            font-size: 22px;
        }

        /* Profile Page */
        .profile-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 7000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .profile-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .profile-container {
            background: var(--surface-color);
            border-radius: 16px;
            width: 90%;
            max-width: 500px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            transform: translateY(20px);
            transition: transform 0.3s ease;
            position: relative;
        }

        .profile-modal.active .profile-container {
            transform: translateY(0);
        }

        .profile-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .profile-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-color-primary);
        }

        .close-profile {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-color-secondary);
            font-size: 24px;
        }

        .profile-avatar-container {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--primary-accent-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 40px;
            margin-bottom: 15px;
        }

        .profile-info {
            margin-bottom: 25px;
        }

        .profile-info-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .profile-info-label {
            font-weight: 600;
            color: var(--text-color-primary);
        }

        .profile-info-value {
            color: var(--text-color-secondary);
        }

        .profile-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        /* Admin Panel */
        .admin-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 8000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .admin-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .admin-container {
            background: var(--surface-color);
            border-radius: 16px;
            width: 90%;
            max-width: 800px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            transform: translateY(20px);
            transition: transform 0.3s ease;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .admin-modal.active .admin-container {
            transform: translateY(0);
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .admin-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-color-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-title .material-icons {
            color: var(--admin-color);
            font-size: 28px;
        }

        .close-admin {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-color-secondary);
            font-size: 24px;
        }

        .admin-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 20px;
        }

        .admin-tab {
            padding: 10px 20px;
            cursor: pointer;
            font-weight: 500;
            color: var(--text-color-secondary);
            border-bottom: 2px solid transparent;
            transition: all 0.2s ease;
        }

        .admin-tab.active {
            color: var(--admin-color);
            border-bottom-color: var(--admin-color);
        }

        .admin-tab-content {
            display: none;
        }

        .admin-tab-content.active {
            display: block;
        }

        .admin-users-list {
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .admin-user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            background: var(--bg-color);
        }

        .admin-user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-accent-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 16px;
        }

        .admin-user-name {
            font-weight: 500;
            color: var(--text-color-primary);
        }

        .admin-user-email {
            font-size: 12px;
            color: var(--text-color-secondary);
        }

        .admin-user-premium {
            font-size: 12px;
            padding: 3px 8px;
            border-radius: 12px;
            background: var(--premium-color);
            color: white;
        }

        .admin-user-free {
            font-size: 12px;
            padding: 3px 8px;
            border-radius: 12px;
            background: var(--text-color-secondary);
            color: white;
        }

        .admin-user-expiry {
            font-size: 10px;
            color: var(--text-color-secondary);
            margin-top: 2px;
        }

        .admin-user-actions {
            display: flex;
            gap: 8px;
        }

        .admin-form-group {
            margin-bottom: 15px;
        }

        .admin-form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: var(--text-color-primary);
        }

        .admin-form-group input,
        .admin-form-group textarea,
        .admin-form-group select {
            width: 100%;
            padding: 10px 12px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background: var(--bg-color);
            color: var(--text-color-primary);
            font-size: 14px;
            font-family: var(--font-body);
            outline: none;
            transition: border-color 0.2s ease;
        }

        .admin-form-group input:focus,
        .admin-form-group textarea:focus,
        .admin-form-group select:focus {
            border-color: var(--primary-accent-color);
        }

        .admin-form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        /* Utility Classes */
        .loading-message {
            text-align: center;
            color: var(--text-color-secondary);
            font-style: italic;
            margin: 40px auto;
            width: 100%;
            font-size: 16px;
        }

        .hidden {
            display: none !important;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        /* Keyframes */
        @keyframes pulse {
            0%,
            100% {
                opacity: 0.7;
            }
            50% {
                opacity: 1;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes fadeInUpSmall {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes zoomIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .app-title {
                display: none;
            }
            .popular-card-item {
                flex: 0 0 260px;
            }
            .item-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            }
            .detail-card {
                flex-direction: column;
                text-align: center;
            }
            .lightbox-prev {
                left: 5px;
            }
            .lightbox-next {
                right: 5px;
            }
            .lightbox-close {
                top: 10px;
                right: 10px;
                font-size: 32px;
                background: rgba(0, 0, 0, 0.3);
                border-radius: 50%;
                width: 40px;
                height: 40px;
            }
            .detail-actions .btn {
                min-width: 120px;
            }
            .user-name {
                display: none;
            }
            .admin-tabs {
                flex-wrap: wrap;
            }
            .admin-tab {
                flex: 1;
                text-align: center;
                padding: 10px;
            }
            .pricing-grid {
                grid-template-columns: 1fr;
            }
            .payment-options {
                flex-direction: column;
                align-items: center;
            }
            .payment-option {
                width: 100%;
                max-width: 250px;
            }
        }

        @media (max-width: 480px) {
            .item-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .popular-card-item {
                flex: 0 0 240px;
            }
            .popular-card-base {
                height: 180px;
            }
            .popular-app-logo-wrapper {
                width: 80px;
                height: 80px;
                border-radius: 20px;
                border-width: 2px;
            }
            .popular-app-logo {
                width: 100%;
                height: 100%;
                border-radius: inherit;
                object-fit: contain;
            }
            .popular-card-app-name {
                font-size: 14px;
            }
            .detail-actions .btn {
                flex: 1 1 100%;
                min-width: unset;
            }
            .android-badge {
                top: 10px;
                right: 10px;
                font-size: 10px;
                padding: 3px 6px;
                width: 28px;
                height: 28px;
            }
            .android-badge .material-icons {
                font-size: 12px;
            }
            .auth-container,
            .profile-container,
            .premium-container {
                width: 95%;
                padding: 20px 15px;
            }
            .user-profile-menu {
                width: 200px;
            }
            .admin-user-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            .admin-user-actions {
                width: 100%;
                justify-content: flex-end;
            }
        }
    </style>
</head>
<body class="">
    <!-- Auth Modals -->
    <div id="loginModal" class="auth-modal">
        <div class="auth-container">
            <div class="auth-header">
                <h3 class="auth-title">Login</h3>
                <button class="close-auth"><span class="material-icons">close</span></button>
            </div>
            <form class="auth-form" id="loginForm">
                <input type="email" id="loginEmail" placeholder="Email" required="">
                <input type="password" id="loginPassword" placeholder="Password" required="">
                <p class="auth-error" id="loginError"></p>
                <button type="submit" class="btn btn-primary">Login</button>
            </form>
            <div class="auth-actions">
                <button class="auth-switch" id="showSignup">Create an account</button>
            </div>
        </div>
    </div>

    <div id="signupModal" class="auth-modal">
        <div class="auth-container">
            <div class="auth-header">
                <h3 class="auth-title">Sign Up</h3>
                <button class="close-auth"><span class="material-icons">close</span></button>
            </div>
            <form class="auth-form" id="signupForm">
                <input type="text" id="signupName" placeholder="Full Name" required="">
                <input type="email" id="signupEmail" placeholder="Email" required="">
                <input type="password" id="signupPassword" placeholder="Password (min 6 chars)" required="">
                <p class="auth-error" id="signupError"></p>
                <button type="submit" class="btn btn-primary">Sign Up</button>
            </form>
            <div class="auth-actions">
                <button class="auth-switch" id="showLogin">Already have an account?</button>
            </div>
        </div>
    </div>

    <!-- Premium Modal -->
    <div id="premiumModal" class="premium-modal">
        <div class="premium-container">
            <div class="premium-header">
                <h2 class="premium-title">
                    <span class="material-icons">workspace_premium</span>
                    Premium Membership
                </h2>
                <button class="close-premium"><span class="material-icons">close</span></button>
            </div>
            
            <div id="premiumStatus" class="premium-status">
                    <h3>Free Account</h3>
                    <p>Upgrade to unlock all premium features</p>
                </div>
            
            <div class="premium-features">
                <h4><span class="material-icons">star</span> Premium Features</h4>
                <ul>
                    <li>
                        <span class="material-icons">lock_open</span>
                        Access to all premium downloads
                    </li>
                    <li>
                        <span class="material-icons">speed</span>
                        Faster download speeds
                    </li>
                    <li>
                        <span class="material-icons">new_releases</span>
                        Early access to new releases
                    </li>
                    <li>
                        <span class="material-icons">support_agent</span>
                        Priority support
                    </li>
                    <li>
                        <span class="material-icons">ads_off</span>
                        Ad-free experience
                    </li>
                </ul>
            </div>
            
            <div class="premium-pricing">
                <h4><span class="material-icons">paid</span> Pricing Plans</h4>
                <div class="pricing-grid">
                    <div class="pricing-tier">
                        <div class="pricing-header">
                            <h3>1 Month</h3>
                            <div class="price">$4.99</div>
                        </div>
                        <ul class="pricing-features">
                            <li><span class="material-icons">check</span> All premium features</li>
                            <li><span class="material-icons">check</span> 30 days access</li>
                        </ul>
                        <button class="btn btn-premium" onclick="selectPlan(1)">Select Plan</button>
                    </div>
                    <div class="pricing-tier popular">
                        <div class="popular-badge">MOST POPULAR</div>
                        <div class="pricing-header">
                            <h3>3 Months</h3>
                            <div class="price">$12.99</div>
                        </div>
                        <ul class="pricing-features">
                            <li><span class="material-icons">check</span> All premium features</li>
                            <li><span class="material-icons">check</span> 90 days access</li>
                            <li><span class="material-icons">check</span> Priority support</li>
                        </ul>
                        <button class="btn btn-premium" onclick="selectPlan(3)">Select Plan</button>
                    </div>
                    <div class="pricing-tier">
                        <div class="pricing-header">
                            <h3>1 Year</h3>
                            <div class="price">$4.99</div>
                        </div>
                        <ul class="pricing-features">
                            <li><span class="material-icons">check</span> All premium features</li>
                            <li><span class="material-icons">check</span> 365 days access</li>
                            <li><span class="material-icons">check</span> Priority support</li>
                            <li><span class="material-icons">check</span> Exclusive content</li>
                        </ul>
                        <button class="btn btn-premium" onclick="selectPlan(12)">Select Plan</button>
                    </div>
                </div>
            </div>
            
            <div class="payment-methods">
                <h4><span class="material-icons">payment</span> Payment Method</h4>
                <div class="payment-options">
                    <div class="payment-option active" data-method="upi">
                        <span class="material-icons">account_balance</span>
                        <span>UPI Payment</span>
                    </div>
                </div>
                <p style="margin-top: 10px; font-size: 14px; color: var(--text-color-secondary);">
                    You'll be redirected to a secure UPI payment page to complete your transaction.
                </p>
            </div>
            
            <div class="premium-actions">
                <button class="btn btn-upi" onclick="processPayment()">
                    <span class="material-icons">payment</span>
                    Complete Payment
                </button>
                <a href="payment.html" target="_blank" class="btn btn-secondary">
                    <span class="material-icons">contact_support</span>
                    Contact Admin
                </a>
            </div>
        </div>
    </div>

    <!-- Profile Page -->
    <div id="profileModal" class="profile-modal">
        <div class="profile-container">
            <div class="profile-header">
                <h2 class="profile-title">My Profile</h2>
                <button class="close-profile"><span class="material-icons">close</span></button>
            </div>
            
            <div class="profile-avatar-container">
                <div class="profile-avatar" id="profileAvatar">U</div>
            </div>
            
            <div class="profile-info">
                <div class="profile-info-item">
                    <span class="profile-info-label">Name:</span>
                    <span class="profile-info-value" id="profileName">User</span>
                </div>
                <div class="profile-info-item">
                    <span class="profile-info-label">Email:</span>
                    <span class="profile-info-value" id="profileEmail">user@example.com</span>
                </div>
                <div class="profile-info-item">
                    <span class="profile-info-label">Account Type:</span>
                    <span class="profile-info-value" id="profileAccountType">Free</span>
                </div>
                <div class="profile-info-item" id="profileExpiryContainer" style="display: none;">
                    <span class="profile-info-label">Premium Expires:</span>
                    <span class="profile-info-value" id="profileExpiry">N/A</span>
                </div>
                <div class="profile-info-item" id="profileDaysLeftContainer" style="display: none;">
                    <span class="profile-info-label">Days Remaining:</span>
                    <span class="profile-info-value" id="profileDaysLeft">N/A</span>
                </div>
            </div>
            
            <div class="profile-actions">
                <button class="btn btn-premium" onclick="showPremiumModal()">Upgrade to Premium</button>
                <button class="btn btn-secondary" onclick="hideProfileModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div class="admin-panel hidden" id="adminPanel">
        <button class="admin-btn" id="adminToggleBtn"><span class="material-icons">admin_panel_settings</span></button>
        <div class="admin-menu" id="adminMenu">
            <div class="admin-menu-item" id="manageUsersBtn">
                <span class="material-icons">people</span>
                <span>Manage Users</span>
            </div>
            <div class="admin-menu-item" id="addItemBtn">
                <span class="material-icons">add</span>
                <span>Add New Item</span>
            </div>
            <div class="admin-menu-item" id="viewStatsBtn">
                <span class="material-icons">analytics</span>
                <span>View Stats</span>
            </div>
        </div>
    </div>

    <!-- Admin Modal -->
    <div id="adminModal" class="admin-modal">
        <div class="admin-container">
            <div class="admin-header">
                <h2 class="admin-title">
                    <span class="material-icons">admin_panel_settings</span>
                    Admin Panel
                </h2>
                <button class="close-admin"><span class="material-icons">close</span></button>
            </div>
            
            <div class="admin-tabs">
                <div class="admin-tab active" data-tab="users">Users</div>
                <div class="admin-tab" data-tab="items">Items</div>
                <div class="admin-tab" data-tab="settings">Settings</div>
            </div>
            
            <div class="admin-tab-content active" id="usersTab">
                <div class="admin-users-list" id="adminUsersList">
                    <p class="loading-message">Loading users...</p>
                </div>
                <div class="admin-form-group">
                    <label>Manual Premium Activation</label>
                    <input type="text" id="manualPremiumEmail" placeholder="Enter user email">
                    <select id="manualPremiumDuration">
                        <option value="1">1 Month (₹4.99)</option>
                        <option value="3">3 Months (₹12.99)</option>
                        <option value="12">1 Year (₹39.99)</option>
                    </select>
                    <div class="admin-form-actions">
                        <button class="btn btn-premium" id="activatePremiumBtn">Activate Premium</button>
                        <button class="btn btn-danger" id="revokePremiumBtn">Revoke Premium</button>
                    </div>
                </div>
            </div>
            
            <div class="admin-tab-content" id="itemsTab">
                <div class="admin-form-group">
                    <label for="itemName">Item Name</label>
                    <input type="text" id="itemName" placeholder="Enter item name">
                </div>
                <div class="admin-form-group">
                    <label for="itemType">Item Type</label>
                    <select id="itemType">
                        <option value="app">App</option>
                        <option value="game">Game</option>
                        <option value="editing">Editing</option>
                    </select>
                </div>
                <div class="admin-form-group">
                    <label for="itemDescription">Description</label>
                    <textarea id="itemDescription" rows="3" placeholder="Enter item description"></textarea>
                </div>
                <div class="admin-form-actions">
                    <button class="btn btn-primary" id="saveItemBtn">Save Item</button>
                    <button class="btn btn-secondary" onclick="hideAdminModal()">Cancel</button>
                </div>
            </div>
            
            <div class="admin-tab-content" id="settingsTab">
                <div class="admin-form-group">
                    <label>Premium Pricing</label>
                    <div class="price-input-group">
                        <label>1 Month Price (₹)</label>
                        <input type="number" id="price1Month" value="4.99" min="1" step="0.01">
                    </div>
                    <div class="price-input-group">
                        <label>3 Months Price (₹)</label>
                        <input type="number" id="price3Months" value="12.99" min="1" step="0.01">
                    </div>
                    <div class="price-input-group">
                        <label>1 Year Price (₹)</label>
                        <input type="number" id="price1Year" value="39.99" min="1" step="0.01">
                    </div>
                    <div class="admin-form-actions">
                        <button class="btn btn-primary" id="savePricingBtn">Save Pricing</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Search Overlay -->
    <div id="searchOverlay" class="search-overlay">
        <div class="search-overlay-header">
            <input type="text" id="mainSearchInput" placeholder="I want to find...">
            <button class="close-search-btn">Cancel</button>
        </div>
        <div id="searchResultsContainer" class="item-grid">
            <p class="loading-message" style="grid-column: 1 / -1;">Start typing to see results.</p>
        </div>
    </div>

    <!-- Side Menu -->
    <div class="menu-overlay"></div>
    <div class="side-menu">
        <div class="side-menu-header">
            <div class="side-menu-brand">
                <img src="https://i.postimg.cc/gJNGB7g2/aryan.jpg" alt="💠⚜️ Aryan x OFFICAL ⚜️💠 Logo">
                <h1 class="app-title">Join On Tg @ARYANxOFFICIAL</h1>
            </div>
            <button class="close-menu-btn">
                <span class="material-icons">close</span>
            </button>
        </div>
        <nav class="side-menu-nav">
            <a data-target="home" class="side-menu-nav-item nav-home">
                <span class="material-icons">home</span>
                <div>Home</div>
            </a>
            <a data-target="app" class="side-menu-nav-item nav-apps">
                <span class="material-icons">apps</span>
                <div>Apps</div>
            </a>
            <a data-target="game" class="side-menu-nav-item nav-games">
                <span class="material-icons">games</span>
                <div>Games</div>
            </a>
            <a data-target="editing" class="side-menu-nav-item nav-editing">
                <span class="material-icons">movie</span>
                <div>Editing</div>
            </a>
        </nav>
        <div class="side-menu-footer">
            <a href="#">Feedback</a>
            <a href="#">Terms of use</a>
            <a href="#">DMCA</a>
            <a href="#">Copyright Holders</a>
        </div>
    </div>

    <!-- User Profile Menu -->
    <div class="user-profile-menu" id="userProfileMenu">
        <div class="user-profile-menu-item" id="viewProfileBtn">
            <span class="material-icons">account_circle</span>
            <span>My Profile</span>
        </div>
        <div class="user-profile-menu-item" id="premiumBtn">
            <span class="material-icons">workspace_premium</span>
            <span>Premium Membership</span>
        </div>
        <div class="user-profile-menu-item" id="logoutBtn">
            <span class="material-icons">logout</span>
            <span>Logout</span>
        </div>
    </div>

    <div id="mainContent">
        <div class="header">
            <div class="header-left">
                <button class="menu-btn"><span class="material-icons">menu</span></button>
                <div id="appLogo" class="app-logo">
                    <img src="https://i.postimg.cc/gJNGB7g2/aryan.jpg" alt="💠⚜️ Aryan x offical ⚜️💠 Logo">
                </div>
                <h1 class="app-title">Join On Tg : @ARYANxOFFICIAL</h1>
            </div>
            <div class="header-right">
                <div id="userProfile" class="user-profile hidden">
                    <div class="user-avatar" id="userAvatar">A</div>
                    <span class="user-name" id="userName">ADITYA SAH</span>
                </div>
                <button class="search-btn"><span class="material-icons">search</span></button>
                <button id="authBtn" class="btn btn-secondary" style="padding: 8px 15px;">Login</button>
            </div>
        </div>

        <div class="container">
            <div id="popularSection" class="section active" style="display: block;">
                <div id="popular-section-header" class="section-header">
                    <span class="material-icons section-icon" style="color: #ff3d71;">whatshot</span>
                    <h2 class="section-title">Hot Apps</h2>
                </div>
                <div id="popularList" class="popular-carousel"><p class="loading-message">No popular items found.</p></div>
            </div>

            <div id="latestSection" class="section active" style="display: block;">
                <div id="latest-section-header" class="section-header">
                    <span class="material-icons section-icon" style="color: #536dfe;">grid_view</span>
                    <h2 class="section-title">Latest Posts</h2>
                </div>
                <div id="latestList" class="item-grid"><p class="loading-message" style="grid-column: 1 / -1;">No items found.</p></div>
                <div id="latestPagination" class="pagination hidden"></div>
            </div>

            <div id="editingSection" class="section active" style="display: block;">
                <div id="editing-section-header" class="section-header">
                    <span class="material-icons section-icon" style="color: #ffab00;">movie</span>
                    <h2 class="section-title">Editing</h2>
                </div>
                <div id="editingList" class="item-grid editing-grid"><p class="loading-message" style="grid-column: 1 / -1;">No items found.</p></div>
                <div id="editingPagination" class="pagination hidden"></div>
            </div>

            <div id="footerSection" class="section active" style="display: block;">
                <div id="news-banner-container">
                    <div class="news-banner">
                        <span class="section-title">Latest News</span>
                        <span class="material-icons">arrow_forward_ios</span>
                    </div>
                </div>
                <div class="footer-banner">
                    <img src="https://i.postimg.cc/gJNGB7g2/aryan.jpg" alt="hackertmm">
                    <p>Copyright © 2026 | dev by @ARYANxOFFICIALBOT</p>
                </div>
            </div>
        </div>
    </div>

    <div id="sectionDetail" class="section hidden">
        <div class="container">
            <div class="detail-header">
                <button class="btn-back" onclick="hideDetailSection()">
                    <span class="material-icons">arrow_back</span>
                </button>
                <h2 class="detail-title">Details</h2>
            </div>
            <div class="detail-card">
                <img id="detailAppImage" src="" alt="Item Icon" class="placeholder">
                <div class="detail-info">
                    <h3 id="detailAppName">Item Name</h3>
                    <p id="detailAppType">Type: <span>App</span></p>
                    <div id="detailStarRating">
                        <span class="stars">☆☆☆☆☆</span>
                        <span class="review-count">(0 reviews)</span>
                    </div>
                </div>
            </div>
            <div class="detail-actions">
                <a href="#" target="_blank" id="detailAppDownloadLink" class="btn btn-primary">
                    <span class="material-icons">download</span><span class="button-label">Download</span>
                </a>
                <a href="#" target="_blank" id="detailPremiumDownloadLink" class="btn btn-premium">
                    <span class="material-icons">star</span><span class="button-label">Premium Download</span>
                </a>
                <button class="btn btn-secondary" onclick="scrollToReviews()">
                    <span class="material-icons">refresh</span><span class="button-label">Request Update</span>
                </button>
            </div>

            <div id="screenshotSection" class="detail-section-content hidden">
                <h4 class="subtitle">Screenshots</h4>
                <div id="screenshotGallery" class="screenshot-gallery"></div>
            </div>

            <div class="detail-section-content">
                <h4 class="subtitle">About this item</h4>
                <div id="detailAppDescContainer">
                    <ul></ul>
                </div>
            </div>
            <div class="detail-section-content review-section">
                <h4 class="subtitle">Ratings &amp; Reviews</h4>
                <div class="review-form">
                    <h4 class="subtitle" style="font-size: 16px;">Rate this item</h4>
                    <input type="text" id="reviewUserName" placeholder="Your Name" required="">
                    <div class="star-rating">
                        <input type="radio" name="rating" id="star5" value="5" required=""><label for="star5" title="5 stars">★</label>
                        <input type="radio" name="rating" id="star4" value="4"><label for="star4" title="4 stars">★</label>
                        <input type="radio" name="rating" id="star3" value="3"><label for="star3" title="3 stars">★</label>
                        <input type="radio" name="rating" id="star2" value="2"><label for="star2" title="2 stars">★</label>
                        <input type="radio" name="rating" id="star1" value="1"><label for="star1" title="1 star">★</label>
                    </div>
                    <textarea id="reviewComment" placeholder="Write a review..." required=""></textarea>
                    <button class="btn btn-primary" onclick="submitReview(event)">Post Review</button>
                </div>
                <h4 class="subtitle" style="margin-top: 24px;">User Reviews</h4>
                <div id="reviewList">
                    <p class="loading-message" style="margin-top:10px; font-size:14px;">No reviews yet. Be the first!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Fullscreen Screenshot Lightbox -->
    <div id="lightboxOverlay" class="lightbox-overlay">
        <div class="lightbox-content">
            <img id="lightboxImage" class="lightbox-image" src="" alt="Fullscreen Screenshot">
            <button id="lightboxClose" class="lightbox-close">×</button>
            <button id="lightboxPrev" class="lightbox-nav lightbox-prev material-icons">chevron_left</button>
            <button id="lightboxNext" class="lightbox-nav lightbox-next material-icons">chevron_right</button>
        </div>
    </div>

    <script>
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyAfxyYXOizJgcAPS0gy4cOCM5Et0MZCA1E",
  authDomain: "aryan-x-offical.firebaseapp.com",
  projectId: "aryan-x-offical",
  storageBucket: "aryan-x-offical.firebasestorage.app",
  messagingSenderId: "238049583208",
  appId: "1:238049583208:web:542d6462259bee1ba55bdd",
  measurementId: "G-P4QNZ83BR3"
};
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const auth = firebase.auth();
        /************************************/

        // --- Config ---
        const NEW_DURATION_MS = 2 * 24 * 60 * 60 * 1000;
        const ITEMS_PER_PAGE = 12;
        const ADMIN_EMAILS = ["illusionxaryan@gmail.com"]; // Add your admin emails here
        const PRICES = {
            1: 4.99,
            3: 12.99,
            12: 39.99
        };

        // --- State ---
        let allItems = [];
        let allUsers = [];
        let currentItem = null;
        let currentFilter = 'home';
        let currentScreenshotIndex = 0;
        let currentUser = null;
        let isAdmin = false;
        let selectedPlan = null;
        let selectedPaymentMethod = 'upi'; // Only UPI now
        let pageStates = {
            home_latest: 1,
            home_editing: 1, 
            app: 1,
            game: 1,
            editing: 1 
        };

        // --- DOM Elements ---
        const mainContent = document.getElementById('mainContent');
        const detailSection = document.getElementById('sectionDetail');
        const menuBtn = document.querySelector('.menu-btn');
        const closeMenuBtn = document.querySelector('.close-menu-btn');
        const sideMenu = document.querySelector('.side-menu');
        const menuOverlay = document.querySelector('.menu-overlay');
        const navItems = document.querySelectorAll('.side-menu-nav-item');
        const searchBtn = document.querySelector('.search-btn');
        const searchOverlay = document.getElementById('searchOverlay');
        const mainSearchInput = document.getElementById('mainSearchInput');
        const appLogo = document.getElementById('appLogo');
        const lightboxOverlay = document.getElementById('lightboxOverlay');
        const authBtn = document.getElementById('authBtn');
        const userProfile = document.getElementById('userProfile');
        const userAvatar = document.getElementById('userAvatar');
        const userName = document.getElementById('userName');
        const adminPanel = document.getElementById('adminPanel');
        const adminToggleBtn = document.getElementById('adminToggleBtn');
        const adminMenu = document.getElementById('adminMenu');
        const userProfileMenu = document.getElementById('userProfileMenu');
        const premiumModal = document.getElementById('premiumModal');
        const closePremiumBtn = document.querySelector('.close-premium');
        const premiumStatus = document.getElementById('premiumStatus');
        const viewProfileBtn = document.getElementById('viewProfileBtn');
        const premiumBtn = document.getElementById('premiumBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        
        // Profile elements
        const profileModal = document.getElementById('profileModal');
        const profileAvatar = document.getElementById('profileAvatar');
        const profileName = document.getElementById('profileName');
        const profileEmail = document.getElementById('profileEmail');
        const profileAccountType = document.getElementById('profileAccountType');
        const profileExpiryContainer = document.getElementById('profileExpiryContainer');
        const profileExpiry = document.getElementById('profileExpiry');
        const profileDaysLeftContainer = document.getElementById('profileDaysLeftContainer');
        const profileDaysLeft = document.getElementById('profileDaysLeft');
        
        // Admin elements
        const adminModal = document.getElementById('adminModal');
        const adminUsersList = document.getElementById('adminUsersList');
        const activatePremiumBtn = document.getElementById('activatePremiumBtn');
        const revokePremiumBtn = document.getElementById('revokePremiumBtn');
        const manualPremiumEmail = document.getElementById('manualPremiumEmail');
        const manualPremiumDuration = document.getElementById('manualPremiumDuration');
        const savePricingBtn = document.getElementById('savePricingBtn');
        const price1Month = document.getElementById('price1Month');
        const price3Months = document.getElementById('price3Months');
        const price1Year = document.getElementById('price1Year');
        
        // Auth elements
        const loginModal = document.getElementById('loginModal');
        const signupModal = document.getElementById('signupModal');
        const loginForm = document.getElementById('loginForm');
        const signupForm = document.getElementById('signupForm');
        const showSignup = document.getElementById('showSignup');
        const showLogin = document.getElementById('showLogin');
        const loginError = document.getElementById('loginError');
        const signupError = document.getElementById('signupError');
        const closeAuthBtns = document.querySelectorAll('.close-auth');

        // --- Functions ---
        function toggleMenu() {
            sideMenu.classList.toggle('active');
            menuOverlay.classList.toggle('active');
            document.body.classList.toggle('menu-active');
        }

        function toggleSearch() {
            searchOverlay.classList.toggle('active');
            document.body.classList.toggle('search-active');
            if (searchOverlay.classList.contains('active')) {
                mainSearchInput.focus();
            } else {
                mainSearchInput.value = '';
            }
        }

        function goHome() {
            if (detailSection.classList.contains('active')) {
                hideDetailSection();
            }
            pageStates.home_latest = 1;
            pageStates.home_editing = 1; 
            currentFilter = 'home';
            renderContent('home');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function navigateAndFilter(targetType) {
            if (detailSection.classList.contains('active')) {
                hideDetailSection();
            }
            pageStates[targetType] = 1;
            currentFilter = targetType;
            renderContent(currentFilter);
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function changePage(page, pageType) {
            pageStates[pageType] = page;
            renderContent(currentFilter);

            let sectionId;
            if (pageType === 'home_latest' || currentFilter === 'app' || currentFilter === 'game') {
                sectionId = 'latestSection';
            } else if (pageType === 'home_editing' || currentFilter === 'editing') {
                sectionId = 'editingSection';
            }
            if (sectionId) {
                const headerOffset = 70;
                const elementPosition = document.getElementById(sectionId).offsetTop;
                const offsetPosition = elementPosition - headerOffset;
                window.scrollTo({ top: offsetPosition, behavior: "smooth" });
            }
        }

        function renderContent(filterType = 'home', searchTerm = '') {
            currentFilter = filterType;
            const searchFilteredItems = searchTerm ?
                allItems.filter(item => item.name.toLowerCase().includes(searchTerm.toLowerCase())) :
                allItems;

            document.getElementById('popularSection').style.display = 'none';
            document.getElementById('latestSection').style.display = 'none';
            document.getElementById('editingSection').style.display = 'none';
            document.getElementById('footerSection').style.display = 'none';
            detailSection.classList.remove('active');
            detailSection.classList.add('hidden');
            mainContent.classList.remove('hidden');

            if (filterType === 'home') {
                ['popularSection', 'latestSection', 'editingSection', 'footerSection'].forEach(id => document.getElementById(id).style.display = 'block');
                document.getElementById('latest-section-header').querySelector('.section-title').textContent = 'Latest Posts';
                document.getElementById('editing-section-header').querySelector('.section-title').textContent = 'Editing';

                const popular = searchFilteredItems.filter(i => i.isPremium && (i.type === 'app' || i.type === 'game'));
                renderPopularItems(popular, 'popularList');

                const latestItems = searchFilteredItems.filter(i => i.type === 'app' || i.type === 'game');
                const latestPage = pageStates.home_latest;
                const latestPaginated = latestItems.slice((latestPage - 1) * ITEMS_PER_PAGE, latestPage * ITEMS_PER_PAGE);
                renderItemGrid(latestPaginated, 'latestList', false);
                renderPagination('latestPagination', latestItems.length, ITEMS_PER_PAGE, latestPage, 'home_latest');

                const editingItems = searchFilteredItems.filter(i => i.type === 'editing');
                const editingPage = pageStates.home_editing;
                const editingPaginated = editingItems.slice((editingPage - 1) * ITEMS_PER_PAGE, editingPage * ITEMS_PER_PAGE);
                renderItemGrid(editingPaginated, 'editingList', true);
                renderPagination('editingPagination', editingItems.length, ITEMS_PER_PAGE, editingPage, 'home_editing');

            } else {
                document.getElementById('footerSection').style.display = 'block';
                const itemsToShow = searchFilteredItems.filter(item => item.type === filterType);
                const currentPage = pageStates[filterType];
                const paginatedItems = itemsToShow.slice((currentPage - 1) * ITEMS_PER_PAGE, currentPage * ITEMS_PER_PAGE);

                if (filterType === 'app' || filterType === 'game') {
                    document.getElementById('latestSection').style.display = 'block';
                    document.getElementById('latest-section-header').querySelector('.section-title').textContent = filterType === 'app' ? 'All Apps' : 'All Games';
                    renderItemGrid(paginatedItems, 'latestList', false);
                    renderPagination('latestPagination', itemsToShow.length, ITEMS_PER_PAGE, currentPage, filterType);
                } else if (filterType === 'editing') { 
                    document.getElementById('editingSection').style.display = 'block';
                    document.getElementById('editing-section-header').querySelector('.section-title').textContent = 'All Editing Items';
                    renderItemGrid(paginatedItems, 'editingList', true);
                    renderPagination('editingPagination', itemsToShow.length, ITEMS_PER_PAGE, currentPage, filterType);
                }
            }
        }
        
        function renderPagination(containerId, totalItems, itemsPerPage, currentPage, pageType) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            const totalPages = Math.ceil(totalItems / itemsPerPage);

            if (totalPages <= 1) {
                container.classList.add('hidden');
                return;
            }
            container.classList.remove('hidden');

            if (currentPage > 1) {
                const prevBtn = document.createElement('button');
                prevBtn.innerHTML = `<span class="material-icons">chevron_left</span>`;
                prevBtn.className = 'page-link arrow';
                prevBtn.onclick = () => changePage(currentPage - 1, pageType);
                container.appendChild(prevBtn);
            }

            for (let i = 1; i <= totalPages; i++) {
                const pageBtn = document.createElement('button');
                pageBtn.textContent = i;
                pageBtn.className = 'page-link';
                if (i === currentPage) pageBtn.classList.add('active');
                pageBtn.onclick = () => changePage(i, pageType);
                container.appendChild(pageBtn);
            }

            if (currentPage < totalPages) {
                const nextBtn = document.createElement('button');
                nextBtn.innerHTML = `<span class="material-icons">chevron_right</span>`;
                nextBtn.className = 'page-link arrow';
                nextBtn.onclick = () => changePage(currentPage + 1, pageType);
                container.appendChild(nextBtn);
            }
        }

        async function fetchAllItems() {
            try {
                const snapshot = await database.ref('items').get();
                if (snapshot.exists()) {
                    const data = snapshot.val();
                    allItems = Object.values(data); 
                    allItems.sort((a, b) => a.name.localeCompare(b.name));
                } else {
                    allItems = [];
                }
                renderContent('home');
            } catch (error) {
                console.error("Error fetching items from Firebase:", error);
                mainContent.innerHTML = `<p class="loading-message" style="color: #d93025;">Failed to load app data.</p>`;
            }
        }
        
        async function fetchAllUsers() {
            try {
                const snapshot = await database.ref('users').get();
                if (snapshot.exists()) {
                    const data = snapshot.val();
                    allUsers = Object.entries(data).map(([uid, userData]) => ({ uid, ...userData }));
                } else {
                    allUsers = [];
                }
                renderAdminUsersList();
            } catch (error) {
                console.error("Error fetching users from Firebase:", error);
            }
        }
        
        async function updateItemInDB(item) {
             try {
                await database.ref('items/' + item.id).set(item);
                console.log("Item updated successfully in Firebase!");
            } catch(e) {
                console.error("Failed to update item in Firebase:", e);
                alert("Sorry, couldn't save your changes. Please try again.");
                await fetchAllItems(); 
            }
        }

        function isNew(item) {
            return item.addedTimestamp && (Date.now() - item.addedTimestamp) < NEW_DURATION_MS;
        }

        function renderPopularItems(items, elementId) {
            const container = document.getElementById(elementId);
            container.innerHTML = '';
            if (items.length === 0) {
                container.innerHTML = `<p class='loading-message'>No popular items found.</p>`;
                return;
            }
            items.forEach((item) => {
                const cardWrapper = document.createElement("div");
                cardWrapper.className = "popular-card-item";
                cardWrapper.onclick = () => showItemDetail(item);
                const appLogoUrl = item.imageUrl || '';
                const androidVersionText = item.minAndroidVersion ? `${item.minAndroidVersion}+` : '';

                cardWrapper.innerHTML = `
                    <div class="popular-card-base">
                         <div class="popular-card-abstract-bg">
                            <svg viewBox="0 0 280 200" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M0 80C50 20, 150 0, 200 50L200 0L0 0L0 80Z" fill="#78B9F5" opacity="0.6"/>
                                <path d="M120 0C170 20, 250 80, 280 120L280 0Z" fill="#FDD835" opacity="0.7"/>
                                <path d="M0 120C50 180, 150 200, 200 150L200 200L0 200L0 120Z" fill="#F48FB1" opacity="0.6"/>
                                <path d="M100 200C150 180, 250 120, 280 80L280 200Z" fill="#81C784" opacity="0.7"/>
                            </svg>
                        </div>
                        <div class="android-badge">
                            <span class="material-icons">android</span> ${escapeHTML(androidVersionText)}
                        </div>
                        <div class="popular-app-logo-wrapper">
                            <img src="${escapeHTML(appLogoUrl)}" class="popular-app-logo" alt="${escapeHTML(item.name)} Logo" 
                                    onerror="this.onerror=null; this.classList.add('placeholder'); this.src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmYWxsPSJub25lIiBzdHJva2U9IiM1ZjYzNjgiIHN0cm9rZS13aWR0aD0iMS41IiBzdHJva2UtbGluZWNjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cmVjdCB3aWR0aD0iMjAiIGhlaWdoPSIyMCIgeD0iMiIgeT0iMiIgcj0iMiIvPjxwYXRoIGQ9Im05IDExIDMuMTMtMy4xM2ExLjUgMS41IDAgMCAxIDIuMTIwIiAvPjxwYXRoIGQ9Ik01IDE2bDQtMS41IDQgNC0yLjQ0OCAyLjU2NmEyIDIgMCAwIDEtLjY4Mi0uNzA1IiAvPjwvc3ZnPg==';">
                        </div>
                    </div>
                    <h3 class="popular-card-app-name">${escapeHTML(item.name)}</h3>`;
                container.appendChild(cardWrapper);
            });
        }

        function renderItemGrid(items, elementId, isEditingGrid = false) { 
            const container = document.getElementById(elementId);
            container.innerHTML = '';

            if (items.length === 0) {
                container.innerHTML = `<p class='loading-message' style="grid-column: 1 / -1;">No items found.</p>`;
                return;
            }
            items.forEach(item => {
                const card = document.createElement("div");
                card.className = isEditingGrid ? "item-card editing-card" : "item-card"; 
                card.onclick = () => showItemDetail(item);
                const newTagHTML = isNew(item) ? '<div class="new-tag">NEW</div>' : '';
                const imgClass = item.imageUrl ? 'item-card-icon' : 'item-card-icon placeholder';
                const reviews = Array.isArray(item.reviews) ? item.reviews : [];
                const avgRating = reviews.length > 0 ? (reviews.reduce((s, r) => s + Number(r.rating), 0) / reviews.length).toFixed(1) : 'N/A';
                
                let cardContent = `${newTagHTML}<div class="item-card-icon-container"><img src="${escapeHTML(item.imageUrl)}" class="${imgClass}" alt="${escapeHTML(item.name)} icon" onerror="this.onerror=null; this.classList.add('placeholder'); this.src='';"></div><div class="item-card-title">${escapeHTML(item.name)}</div><div class="item-card-type">${escapeHTML(item.type)}</div>`;
                if (!isEditingGrid) {
                    cardContent += `<div class="item-card-info"><span>★ ${avgRating}</span><span>v${item.version || '1.0'}</span></div>`;
                }
                card.innerHTML = cardContent;
                container.appendChild(card);
            });
        }

        function showItemDetail(item) {
            currentItem = item;
            mainContent.classList.add('hidden');
            detailSection.classList.remove('hidden');
            detailSection.classList.add('active');
            window.scrollTo(0, 0);

            const imgEl = document.getElementById("detailAppImage");
            imgEl.src = item.imageUrl ? escapeHTML(item.imageUrl) : '';
            imgEl.onerror = function() {
                this.onerror = null;
                this.classList.add('placeholder');
                this.src = '';
            };
            item.imageUrl ? imgEl.classList.remove('placeholder') : imgEl.classList.add('placeholder');
            document.getElementById("detailAppName").textContent = escapeHTML(item.name);
            document.getElementById("detailAppType").querySelector('span').textContent = escapeHTML(item.type.charAt(0).toUpperCase() + item.type.slice(1));
            
            const starRatingEl = document.getElementById("detailStarRating");
            const starsContainer = starRatingEl.querySelector(".stars");
            const reviewCountContainer = starRatingEl.querySelector(".review-count");
            const reviews = Array.isArray(item.reviews) ? item.reviews : [];
            const reviewCount = reviews.length;
            if (reviewCount > 0) {
                const avgRating = reviews.reduce((sum, r) => sum + (Number(r.rating) || 0), 0) / reviewCount;
                starsContainer.innerHTML = '★'.repeat(Math.round(avgRating)) + '☆'.repeat(5 - Math.round(avgRating));
                reviewCountContainer.textContent = `(${reviewCount} review${reviewCount !== 1 ? 's' : ''})`;
            } else {
                starsContainer.innerHTML = '☆☆☆☆☆';
                reviewCountContainer.textContent = `(0 reviews)`;
            }

            const actionBtn = document.getElementById("detailAppDownloadLink");
            actionBtn.href = escapeHTML(item.url || "#");
            
            const premiumBtn = document.getElementById("detailPremiumDownloadLink");
            premiumBtn.href = escapeHTML(item.premiumUrl || "#");
            
            // Update premium button state based on user status
            if (currentUser && currentUser.isPremium) {
                premiumBtn.classList.remove('btn-disabled');
                premiumBtn.onclick = null;
            } else {
                premiumBtn.classList.add('btn-disabled');
                premiumBtn.onclick = (e) => {
                    e.preventDefault();
                    showPremiumModal();
                    alert('Please upgrade to premium to access this download');
                };
            }

            const screenshotSection = document.getElementById("screenshotSection");
            const screenshotGallery = document.getElementById("screenshotGallery");
            screenshotGallery.innerHTML = '';
            if (item.screenshots && Array.isArray(item.screenshots) && item.screenshots.length > 0) {
                screenshotSection.classList.remove('hidden');
                item.screenshots.forEach((ssUrl, index) => {
                    const img = document.createElement('img');
                    img.src = escapeHTML(ssUrl);
                    img.className = 'screenshot-img';
                    img.alt = `${escapeHTML(item.name)} screenshot ${index + 1}`;
                    img.onclick = () => showLightbox(index);
                    img.onerror = function() { this.style.display = 'none'; };
                    screenshotGallery.appendChild(img);
                });
            } else {
                screenshotSection.classList.add('hidden');
            }

            const descContainer = document.getElementById("detailAppDescContainer").querySelector('ul');
            descContainer.innerHTML = '';
            if (item.desc && Array.isArray(item.desc)) {
                item.desc.forEach(fText => {
                    const li = document.createElement('li');
                    li.innerHTML = `<span class="material-icons">check_circle</span><span>${escapeHTML(fText)}</span>`;
                    descContainer.appendChild(li);
                });
            } else {
                descContainer.innerHTML = '<li>No description available.</li>';
            }
            
            renderReviews(reviews);
            document.getElementById("reviewUserName").value = '';
            document.getElementById("reviewComment").value = '';
            document.querySelectorAll('#sectionDetail .star-rating input').forEach(r => r.checked = false);
        }

        function hideDetailSection() {
            currentItem = null;
            mainContent.classList.remove('hidden');
            detailSection.classList.add('hidden');
            detailSection.classList.remove('active');
            renderContent(currentFilter);
        }

        function renderReviews(reviewsArray) {
            const reviewListDiv = document.getElementById("reviewList");
            reviewListDiv.innerHTML = '';
            if (reviewsArray && reviewsArray.length > 0) {
                // Sort reviews by timestamp, newest first
                const sortedReviews = reviewsArray.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                sortedReviews.forEach(review => {
                    const div = document.createElement("div");
                    div.className = "review-item";
                    const rating = Number(review.rating) || 0;
                    const stars = '★'.repeat(Math.round(rating)) + '☆'.repeat(5 - Math.round(rating));
                    div.innerHTML = `<p><strong>${escapeHTML(review.userName)}</strong></p><p class="review-stars">${stars}</p><p>${escapeHTML(review.comment || "")}</p>`;
                    reviewListDiv.appendChild(div);
                });
            } else {
                reviewListDiv.innerHTML = '<p class="loading-message" style="margin:10px 0; font-size:14px;">No reviews yet. Be the first!</p>';
            }
        }

        async function submitReview(event) {
            event.preventDefault();
            if (!currentItem) return;
            const userName = document.getElementById("reviewUserName").value.trim();
            const ratingInput = document.querySelector('#sectionDetail .star-rating input:checked');
            const rating = ratingInput ? parseInt(ratingInput.value) : null;
            const comment = document.getElementById("reviewComment").value.trim();

            if (!userName || rating === null || !comment) {
                 alert("Please provide your name, a rating, and a comment.");
                 return;
            }
            
            const newReview = { userName, rating, comment, timestamp: new Date().toISOString() };
            
            const updatedItem = JSON.parse(JSON.stringify(currentItem));
            if (!updatedItem.reviews || !Array.isArray(updatedItem.reviews)) {
                updatedItem.reviews = [];
            }
            updatedItem.reviews.push(newReview);
            
            showItemDetail(updatedItem); 
            if (ratingInput) ratingInput.checked = false;
            document.getElementById('reviewComment').value = '';
            
            await updateItemInDB(updatedItem);
            
            currentItem = updatedItem;
            const itemIndex = allItems.findIndex(i => i.id === currentItem.id);
            if (itemIndex > -1) {
                allItems[itemIndex] = currentItem;
            }
        }

        function scrollToReviews() {
            const reviewSection = document.querySelector('.review-section');
            if (reviewSection) {
                const headerOffset = 70;
                const elementPosition = reviewSection.getBoundingClientRect().top + window.pageYOffset;
                const offsetPosition = elementPosition - headerOffset;
                window.scrollTo({
                    top: offsetPosition,
                    behavior: "smooth"
                });
                setTimeout(() => {
                    document.getElementById("reviewComment").focus();
                }, 600);
            }
        }
        
        function showLightbox(index) {
            if (!currentItem || !currentItem.screenshots || !Array.isArray(currentItem.screenshots) || currentItem.screenshots.length === 0) {
                return;
            }
            currentScreenshotIndex = index;
            document.body.classList.add('lightbox-active');
            lightboxOverlay.classList.add('active');
            updateLightboxImage();
        }

        function hideLightbox() {
            document.body.classList.remove('lightbox-active');
            lightboxOverlay.classList.remove('active');
        }

        function showNextScreenshot() {
            if (!currentItem || !currentItem.screenshots) return;
            const totalScreenshots = currentItem.screenshots.length;
            if (currentScreenshotIndex < totalScreenshots - 1) {
                currentScreenshotIndex++;
                updateLightboxImage();
            }
        }

        function showPrevScreenshot() {
            if (!currentItem || !currentItem.screenshots) return;
            if (currentScreenshotIndex > 0) {
                currentScreenshotIndex--;
                updateLightboxImage();
            }
        }

        function updateLightboxImage() {
            if (!currentItem || !currentItem.screenshots) return;
            const screenshots = currentItem.screenshots;
            const totalScreenshots = screenshots.length;
            if (currentScreenshotIndex >= totalScreenshots || currentScreenshotIndex < 0) {
                hideLightbox();
                return;
            }
            document.getElementById('lightboxImage').src = escapeHTML(screenshots[currentScreenshotIndex]);
            const lightboxPrev = document.getElementById('lightboxPrev');
            const lightboxNext = document.getElementById('lightboxNext');
            if (totalScreenshots > 1) {
                lightboxPrev.style.display = (currentScreenshotIndex > 0) ? 'flex' : 'none';
                lightboxNext.style.display = (currentScreenshotIndex < totalScreenshots - 1) ? 'flex' : 'none';
            } else {
                lightboxPrev.style.display = 'none';
                lightboxNext.style.display = 'none';
            }
        }
        
        function escapeHTML(str) {
            if (typeof str !== 'string') return '';
            return str.replace(/[&<>"']/g, match => ({ '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;' }[match]));
        }

        /* Auth Functions */
        function showLoginModal() {
            document.body.classList.add('auth-active');
            loginModal.classList.add('active');
            loginError.textContent = '';
        }

        function showSignupModal() {
            document.body.classList.add('auth-active');
            signupModal.classList.add('active');
            signupError.textContent = '';
        }

        function hideAuthModals() {
            document.body.classList.remove('auth-active');
            loginModal.classList.remove('active');
            signupModal.classList.remove('active');
        }

        /* Profile Functions */
        function showProfileModal() {
            if (!currentUser) return;
            
            document.body.classList.add('profile-active');
            profileModal.classList.add('active');
            
            // Update profile info
            profileAvatar.textContent = currentUser.displayName.charAt(0).toUpperCase();
            profileName.textContent = currentUser.displayName;
            profileEmail.textContent = currentUser.email;
            
            if (currentUser.isPremium) {
                profileAccountType.textContent = "Premium";
                profileAccountType.style.color = "var(--premium-color)";
                profileExpiryContainer.style.display = "flex";
                profileDaysLeftContainer.style.display = "flex";
                
                if (currentUser.premiumExpiry) {
                    const expiryDate = new Date(currentUser.premiumExpiry);
                    profileExpiry.textContent = expiryDate.toLocaleDateString();
                    
                    // Calculate days left
                    const now = new Date();
                    const diffTime = expiryDate - now;
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                    
                    if (diffDays > 0) {
                        profileDaysLeft.textContent = `${diffDays} days`;
                        profileDaysLeft.style.color = "var(--success-color)";
                    } else {
                        profileDaysLeft.textContent = "Expired";
                        profileDaysLeft.style.color = "var(--danger-color)";
                    }
                } else {
                    profileExpiry.textContent = "Never";
                    profileDaysLeft.textContent = "Lifetime";
                    profileDaysLeft.style.color = "var(--premium-color)";
                }
            } else {
                profileAccountType.textContent = "Free";
                profileAccountType.style.color = "var(--text-color-secondary)";
                profileExpiryContainer.style.display = "none";
                profileDaysLeftContainer.style.display = "none";
            }
        }

        function hideProfileModal() {
            document.body.classList.remove('profile-active');
            profileModal.classList.remove('active');
        }

        /* Premium Functions */
        function showPremiumModal() {
            document.body.classList.add('premium-modal-active');
            premiumModal.classList.add('active');
            
            // Update premium status display
            if (currentUser && currentUser.isPremium) {
                premiumStatus.innerHTML = `
                    <h3>Premium Member</h3>
                    <p>Thank you for being a premium user!</p>
                `;
                premiumStatus.classList.add('active');
            } else {
                premiumStatus.innerHTML = `
                    <h3>Free Account</h3>
                    <p>Upgrade to unlock all premium features</p>
                `;
                premiumStatus.classList.remove('active');
            }
            
            // Update pricing display
            document.querySelectorAll('.price').forEach(el => {
                const months = parseInt(el.closest('.pricing-tier').querySelector('h3').textContent);
                if (months === 1) el.textContent = `₹${PRICES[1]}`;
                else if (months === 3) el.textContent = `₹${PRICES[3]}`;
                else if (months === 12) el.textContent = `₹${PRICES[12]}`;
            });
        }

        function hidePremiumModal() {
            document.body.classList.remove('premium-modal-active');
            premiumModal.classList.remove('active');
        }

        function selectPlan(months) {
            selectedPlan = months;
            
            // Highlight selected plan
            document.querySelectorAll('.pricing-tier').forEach(tier => {
                tier.classList.remove('selected');
            });
            
            const selectedTier = document.querySelector(`.pricing-tier:nth-child(${months === 1 ? 1 : months === 3 ? 2 : 3})`);
            selectedTier.classList.add('selected');
        }

        function processPayment() {
            if (!selectedPlan) {
                alert('Please select a plan first');
                return;
            }
            
            const amount = PRICES[selectedPlan];
            
            // Redirect to UPI payment page
            const paymentPageUrl = `payment${amount}&plan=${selectedPlan}.html`;
            window.open(paymentPageUrl, '_blank');
            
            // In a real implementation, you would:
            // 1. Open a UPI payment link or page
            // 2. Have a webhook or manual verification process
            // 3. Then call activatePremium() after payment confirmation
        }

        async function activatePremium(months) {
            if (!currentUser) {
                alert('Please login first');
                return;
            }
            
            const expiryDate = new Date();
            expiryDate.setMonth(expiryDate.getMonth() + months);
            
            try {
                await database.ref('users/' + currentUser.uid).update({
                    isPremium: true,
                    premiumExpiry: expiryDate.toISOString()
                });
                
                // Update local state
                currentUser.isPremium = true;
                currentUser.premiumExpiry = expiryDate.toISOString();
                updateUserUI(currentUser);
                
                hidePremiumModal();
                showProfileModal();
                alert(`Premium activated successfully! Your subscription will expire on ${expiryDate.toLocaleDateString()}`);
            } catch (error) {
                console.error("Error activating premium:", error);
                alert("Failed to activate premium. Please try again.");
            }
        }

        /* Admin Functions */
        function showAdminModal() {
            document.body.classList.add('admin-active');
            adminModal.classList.add('active');
            fetchAllUsers();
            
            // Load pricing
            price1Month.value = PRICES[1];
            price3Months.value = PRICES[3];
            price1Year.value = PRICES[12];
        }

        function hideAdminModal() {
            document.body.classList.remove('admin-active');
            adminModal.classList.remove('active');
        }

        function renderAdminUsersList() {
            adminUsersList.innerHTML = '';
            
            if (allUsers.length === 0) {
                adminUsersList.innerHTML = '<p class="loading-message">No users found.</p>';
                return;
            }
            
            allUsers.forEach(user => {
                const userItem = document.createElement('div');
                userItem.className = 'admin-user-item';
                
                const premiumStatus = user.isPremium ? 
                    `<span class="admin-user-premium">Premium</span>` : 
                    `<span class="admin-user-free">Free</span>`;
                
                let expiryInfo = '';
                if (user.isPremium && user.premiumExpiry) {
                    const expiryDate = new Date(user.premiumExpiry);
                    const now = new Date();
                    const diffTime = expiryDate - now;
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                    
                    expiryInfo = `<div class="admin-user-expiry">Expires: ${expiryDate.toLocaleDateString()} (${diffDays > 0 ? diffDays + ' days left' : 'Expired'})</div>`;
                }
                
                userItem.innerHTML = `
                    <div class="admin-user-info">
                        <div class="admin-user-avatar">${user.name ? user.name.charAt(0).toUpperCase() : 'U'}</div>
                        <div>
                            <div class="admin-user-name">${escapeHTML(user.name || user.email.split('@')[0])}</div>
                            <div class="admin-user-email">${escapeHTML(user.email)}</div>
                            ${expiryInfo}
                        </div>
                    </div>
                    <div class="admin-user-actions">
                        ${premiumStatus}
                        <button class="btn btn-admin btn-sm" data-user-id="${user.uid}" onclick="toggleUserPremium('${user.uid}')">
                            <span class="material-icons">${user.isPremium ? 'star' : 'star_outline'}</span>
                        </button>
                    </div>
                `;
                
                adminUsersList.appendChild(userItem);
            });
        }

        async function toggleUserPremium(userId) {
            if (!isAdmin) return;
            
            const user = allUsers.find(u => u.uid === userId);
            if (!user) return;
            
            const newPremiumStatus = !user.isPremium;
            const expiryDate = newPremiumStatus ? 
                new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString() : // Default to 1 month
                null;
            
            try {
                await database.ref('users/' + userId).update({
                    isPremium: newPremiumStatus,
                    premiumExpiry: expiryDate
                });
                
                // Update local state
                const userIndex = allUsers.findIndex(u => u.uid === userId);
                if (userIndex > -1) {
                    allUsers[userIndex].isPremium = newPremiumStatus;
                    allUsers[userIndex].premiumExpiry = expiryDate;
                }
                
                // If the current user is the one being updated, refresh their state
                if (currentUser && currentUser.uid === userId) {
                    currentUser.isPremium = newPremiumStatus;
                    currentUser.premiumExpiry = expiryDate;
                    updateUserUI(currentUser);
                }
                
                renderAdminUsersList();
                alert(`User premium status updated to ${newPremiumStatus ? 'Premium' : 'Free'}`);
            } catch (error) {
                console.error("Error updating user premium status:", error);
                alert("Failed to update user premium status");
            }
        }

        async function activatePremiumManually() {
            const email = manualPremiumEmail.value.trim();
            const duration = parseInt(manualPremiumDuration.value);
            
            if (!email) {
                alert('Please enter a user email');
                return;
            }
            
            // Find user by email
            const user = allUsers.find(u => u.email === email);
            if (!user) {
                alert('User not found');
                return;
            }
            
            // Calculate expiry date
            const expiryDate = new Date();
            expiryDate.setMonth(expiryDate.getMonth() + duration);
            
            try {
                await database.ref('users/' + user.uid).update({
                    isPremium: true,
                    premiumExpiry: expiryDate.toISOString()
                });
                
                // Update local state
                const userIndex = allUsers.findIndex(u => u.uid === user.uid);
                if (userIndex > -1) {
                    allUsers[userIndex].isPremium = true;
                    allUsers[userIndex].premiumExpiry = expiryDate.toISOString();
                }
                
                // If the current user is the one being updated, refresh their state
                if (currentUser && currentUser.uid === user.uid) {
                    currentUser.isPremium = true;
                    currentUser.premiumExpiry = expiryDate.toISOString();
                    updateUserUI(currentUser);
                }
                
                renderAdminUsersList();
                alert(`Premium activated for ${email} for ${duration} month(s)`);
                manualPremiumEmail.value = '';
            } catch (error) {
                console.error("Error activating premium:", error);
                alert("Failed to activate premium");
            }
        }

        async function revokePremiumManually() {
            const email = manualPremiumEmail.value.trim();
            
            if (!email) {
                alert('Please enter a user email');
                return;
            }
            
            // Find user by email
            const user = allUsers.find(u => u.email === email);
            if (!user) {
                alert('User not found');
                return;
            }
            
            try {
                await database.ref('users/' + user.uid).update({
                    isPremium: false,
                    premiumExpiry: null
                });
                
                // Update local state
                const userIndex = allUsers.findIndex(u => u.uid === user.uid);
                if (userIndex > -1) {
                    allUsers[userIndex].isPremium = false;
                    allUsers[userIndex].premiumExpiry = null;
                }
                
                // If the current user is the one being updated, refresh their state
                if (currentUser && currentUser.uid === user.uid) {
                    currentUser.isPremium = false;
                    currentUser.premiumExpiry = null;
                    updateUserUI(currentUser);
                }
                
                renderAdminUsersList();
                alert(`Premium revoked for ${email}`);
                manualPremiumEmail.value = '';
            } catch (error) {
                console.error("Error revoking premium:", error);
                alert("Failed to revoke premium");
            }
        }

        async function savePricing() {
            const newPrices = {
                1: parseFloat(price1Month.value),
                3: parseFloat(price3Months.value),
                12: parseFloat(price1Year.value)
            };
            
            // Validate prices
            if (newPrices[1] <= 0 || newPrices[3] <= 0 || newPrices[12] <= 0) {
                alert('Prices must be greater than 0');
                return;
            }
            
            try {
                // In a real app, you would save to database
                // For this demo, we'll just update local state
                PRICES[1] = newPrices[1];
                PRICES[3] = newPrices[3];
                PRICES[12] = newPrices[12];
                
                alert('Pricing updated successfully!');
            } catch (error) {
                console.error("Error saving pricing:", error);
                alert("Failed to save pricing");
            }
        }

        function updateUserUI(user) {
            if (user) {
                // User is logged in
                authBtn.classList.add('hidden');
                userProfile.classList.remove('hidden');
                
                // Set user avatar and name
                const displayName = user.displayName || user.email.split('@')[0];
                userAvatar.textContent = displayName.charAt(0).toUpperCase();
                userName.textContent = displayName;
                
                // Check if user is admin
                isAdmin = ADMIN_EMAILS.includes(user.email);
                if (isAdmin) {
                    adminPanel.classList.remove('hidden');
                } else {
                    adminPanel.classList.add('hidden');
                }
                
                // Check premium status
                if (user.isPremium) {
                    // Check if premium has expired
                    if (user.premiumExpiry) {
                        const expiryDate = new Date(user.premiumExpiry);
                        const now = new Date();
                        if (now > expiryDate) {
                            // Premium has expired
                            database.ref('users/' + user.uid).update({
                                isPremium: false
                            });
                            user.isPremium = false;
                        }
                    }
                }
            } else {
                // User is signed out
                authBtn.classList.remove('hidden');
                userProfile.classList.add('hidden');
                adminPanel.classList.add('hidden');
                isAdmin = false;
            }
        }

        async function handleLogin(email, password) {
            try {
                const userCredential = await auth.signInWithEmailAndPassword(email, password);
                
                // Get user data from database
                const userSnapshot = await database.ref('users/' + userCredential.user.uid).get();
                const userData = userSnapshot.val();
                
                currentUser = {
                    uid: userCredential.user.uid,
                    email: userCredential.user.email,
                    displayName: userCredential.user.displayName || userCredential.user.email.split('@')[0],
                    isPremium: userData?.isPremium || false,
                    premiumExpiry: userData?.premiumExpiry || null
                };
                
                updateUserUI(currentUser);
                hideAuthModals();
                return true;
            } catch (error) {
                console.error("Login error:", error);
                loginError.textContent = error.message;
                return false;
            }
        }

        async function handleSignup(name, email, password) {
            try {
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                
                // Update user profile with display name
                await userCredential.user.updateProfile({
                    displayName: name
                });
                
                // Create user record in database
                await database.ref('users/' + userCredential.user.uid).set({
                    name: name,
                    email: email,
                    isPremium: false,
                    premiumExpiry: null,
                    createdAt: new Date().toISOString()
                });
                
                currentUser = {
                    uid: userCredential.user.uid,
                    email: userCredential.user.email,
                    displayName: name,
                    isPremium: false,
                    premiumExpiry: null
                };
                
                updateUserUI(currentUser);
                hideAuthModals();
                return true;
            } catch (error) {
                console.error("Signup error:", error);
                signupError.textContent = error.message;
                return false;
            }
        }

        function handleLogout() {
            auth.signOut().then(() => {
                currentUser = null;
                updateUserUI(null);
            }).catch(error => {
                console.error("Logout error:", error);
            });
        }

        function toggleAdminMenu() {
            adminMenu.classList.toggle('active');
        }

        function showManageUsers() {
            showAdminModal();
            // Activate the users tab
            document.querySelectorAll('.admin-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector('.admin-tab[data-tab="users"]').classList.add('active');
            document.querySelectorAll('.admin-tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById('usersTab').classList.add('active');
        }

        function showAddItem() {
            showAdminModal();
            // Activate the items tab
            document.querySelectorAll('.admin-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector('.admin-tab[data-tab="items"]').classList.add('active');
            document.querySelectorAll('.admin-tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById('itemsTab').classList.add('active');
        }

        function showViewStats() {
            showAdminModal();
            // Activate the settings tab
            document.querySelectorAll('.admin-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector('.admin-tab[data-tab="settings"]').classList.add('active');
            document.querySelectorAll('.admin-tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById('settingsTab').classList.add('active');
        }

        // --- Initialization ---
        document.addEventListener("DOMContentLoaded", () => {
            fetchAllItems();

            // Event Listeners
            menuBtn.addEventListener('click', toggleMenu);
            closeMenuBtn.addEventListener('click', toggleMenu);
            menuOverlay.addEventListener('click', toggleMenu);
            appLogo.addEventListener('click', goHome);

            searchBtn.addEventListener('click', toggleSearch);
            document.querySelector('.close-search-btn').addEventListener('click', toggleSearch);

            navItems.forEach(item => {
                const target = item.dataset.target;
                item.addEventListener('click', () => {
                    if (target === 'home') goHome();
                    else navigateAndFilter(target);
                    if (sideMenu.classList.contains('active')) toggleMenu();
                });
            });

            mainSearchInput.addEventListener('input', (e) => {
                const searchTerm = e.target.value.trim().toLowerCase();
                const searchResultsContainer = document.getElementById('searchResultsContainer');
                if (searchTerm) {
                    const items = allItems.filter(item =>
                        item.name.toLowerCase().includes(searchTerm) ||
                        (Array.isArray(item.desc) && item.desc.join(' ').toLowerCase().includes(searchTerm))
                    );
                    renderItemGrid(items, 'searchResultsContainer');
                } else {
                    searchResultsContainer.innerHTML = '<p class="loading-message" style="grid-column: 1 / -1;">Start typing to see results.</p>';
                }
            });

            // Lightbox events
            document.getElementById('lightboxClose').addEventListener('click', hideLightbox);
            document.getElementById('lightboxNext').addEventListener('click', showNextScreenshot);
            document.getElementById('lightboxPrev').addEventListener('click', showPrevScreenshot);
            lightboxOverlay.addEventListener('click', (e) => { if (e.target === lightboxOverlay) hideLightbox(); });
            document.addEventListener('keydown', (e) => {
                if (lightboxOverlay.classList.contains('active')) {
                    if (e.key === 'Escape') hideLightbox();
                    if (e.key === 'ArrowRight') showNextScreenshot();
                    if (e.key === 'ArrowLeft') showPrevScreenshot();
                }
            });

            // Auth events
            authBtn.addEventListener('click', showLoginModal);
            showSignup.addEventListener('click', () => {
                hideAuthModals();
                showSignupModal();
            });
            showLogin.addEventListener('click', () => {
                hideAuthModals();
                showLoginModal();
            });
            closeAuthBtns.forEach(btn => {
                btn.addEventListener('click', hideAuthModals);
            });

            loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;
                await handleLogin(email, password);
            });

            signupForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const name = document.getElementById('signupName').value;
                const email = document.getElementById('signupEmail').value;
                const password = document.getElementById('signupPassword').value;
                await handleSignup(name, email, password);
            });

            // User profile menu events
            userProfile.addEventListener('click', (e) => {
                e.stopPropagation();
                userProfileMenu.classList.toggle('active');
            });

            viewProfileBtn.addEventListener('click', () => {
                userProfileMenu.classList.remove('active');
                showProfileModal();
            });

            premiumBtn.addEventListener('click', () => {
                userProfileMenu.classList.remove('active');
                showPremiumModal();
            });

            logoutBtn.addEventListener('click', () => {
                userProfileMenu.classList.remove('active');
                if (confirm('Are you sure you want to logout?')) {
                    handleLogout();
                }
            });

            // Close user profile menu when clicking outside
            document.addEventListener('click', (e) => {
                if (!userProfile.contains(e.target) && !userProfileMenu.contains(e.target)) {
                    userProfileMenu.classList.remove('active');
                }
            });

            // Profile modal events
            document.querySelector('.close-profile').addEventListener('click', hideProfileModal);
            profileModal.addEventListener('click', (e) => {
                if (e.target === profileModal) {
                    hideProfileModal();
                }
            });

            // Premium modal events
            closePremiumBtn.addEventListener('click', hidePremiumModal);
            premiumModal.addEventListener('click', (e) => {
                if (e.target === premiumModal) {
                    hidePremiumModal();
                }
            });

            // Admin events
            adminToggleBtn.addEventListener('click', toggleAdminMenu);
            manageUsersBtn.addEventListener('click', showManageUsers);
            addItemBtn.addEventListener('click', showAddItem);
            viewStatsBtn.addEventListener('click', showViewStats);

            // Admin modal events
            document.querySelector('.close-admin').addEventListener('click', hideAdminModal);
            adminModal.addEventListener('click', (e) => {
                if (e.target === adminModal) {
                    hideAdminModal();
                }
            });

            // Admin tab switching
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.dataset.tab;
                    document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    document.querySelectorAll('.admin-tab-content').forEach(content => content.classList.remove('active'));
                    document.getElementById(`${tabId}Tab`).classList.add('active');
                });
            });

            // Manual premium activation
            activatePremiumBtn.addEventListener('click', activatePremiumManually);
            revokePremiumBtn.addEventListener('click', revokePremiumManually);

            // Save pricing
            savePricingBtn.addEventListener('click', savePricing);

            // Auth state observer
            auth.onAuthStateChanged((user) => {
                if (user) {
                    // User is signed in
                    database.ref('users/' + user.uid).once('value').then((snapshot) => {
                        const userData = snapshot.val();
                        currentUser = {
                            uid: user.uid,
                            email: user.email,
                            displayName: user.displayName || user.email.split('@')[0],
                            isPremium: userData?.isPremium || false,
                            premiumExpiry: userData?.premiumExpiry || null
                        };
                        updateUserUI(currentUser);
                    });
                } else {
                    // User is signed out
                    currentUser = null;
                    updateUserUI(null);
                }
            });
        });
    </script>

</body></html>